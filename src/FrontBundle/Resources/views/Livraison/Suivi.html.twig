{% extends 'base.html.twig' %}

{% block body %}
    <style>
        .imag{height: 130px; width: 130px}
        .line{height: 130px; width: 130px}
        #demo{font-size: 40px; color: #1e7e34}
        #source{height: 130px;width: 663px}
    </style>
    <section id="page-content" class="page-wrapper" style="    height: 800px;">
        <br> <br>
        <p id="demo" align="center"></p>
        <div style="position: relative ; left: 370px">
<div>
    <img hidden="hidden" id="source" class="imag2"    src="{{ asset('/freak/images/suivi/source.gif') }}" />
</div>
            <input  type="hidden" id="etat" value="{% if liv.Commande is defined %}{{ liv.Commande.etatLivraion  }}{% endif %}" />
            <input  type="hidden" id="statu" value="{% if liv.statut is  defined %}{% if liv.statut==false %}0{% else %}1{% endif %}{% endif %}" />


            <img id="nonaff"  class="imag"   src="{{ asset('/freak/images/suivi/nonAff.png') }}" />
            <img class="line" src="{{ asset('/freak/images/suivi/Line.png') }}" />

            <img id="route" class="imag"    src="{{ asset('/freak/images/suivi/EnRoute.png') }}" />
            <img class="line" src="{{ asset('/freak/images/suivi/Line.png') }}" />
            <img id="livre" class="imag" src="{{ asset('/freak/images/suivi/Livre.svg') }}" />



        </div>
<input type="hidden" id="dat" {% if liv.statut is  defined %} value="{{  liv.dateLivraison| date('Y-m-d H:i:s') }}" {% endif %}>
    </section>
{% endblock %}

{% block js %}


    <script>
        if(document.getElementById("demo").innerHTML != "Commande  livrée"){
if(document.getElementById("dat").value.trim()!="") {
    var parts = document.getElementById("dat").value.trim().split(/[- :]/);
    var dat = new Date(parts[0], parts[1] - 1, parts[2], parts[3], parts[4], parts[5]);


    var countDownDate = dat.getTime();

    // Update the count down every 1 second
    var x = setInterval(function () {

        // Get today's date and time
        var now = new Date().getTime();

        // Find the distance between now and the count down date
        var distance = countDownDate - now;

        // Time calculations for days, hours, minutes and seconds
        var days = Math.floor(distance / (1000 * 60 * 60 * 24));
        var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        var seconds = Math.floor((distance % (1000 * 60)) / 1000);

        // Display the result in the element with id="demo"
        document.getElementById("demo").innerHTML = days + "d " + hours + "h "
            + minutes + "m " + seconds + "s ";

        // If the count down is finished, write some text
        if (distance < 0) {
            clearInterval(x);
            document.getElementById("demo").innerHTML = "Commande  livrée";
        }
    }, 1000);
}else {
    document.getElementById("demo").innerHTML = "Commande  en cours de traitement";
}
        }
    </script>

<script >
    $(document).ready(function () {
        $("#source").hide();
        if ( $("#etat").val() =="" )
            $("#nonaff").css('border','5px solid #1e7e34');
        else if ($("#etat").val().replace("&nbsp;","") == "affecté" &&  $("#statu").val().replace(" ","")=="0"   ){
            $("#route").css('border','5px solid #1e7e34');
            $("#source").show();
        }
        else {
            $("#livre").css('border','5px solid #1e7e34');
            document.getElementById("demo").innerHTML = "Commande  livrée";
        }


    })
</script>
{%  endblock %}

