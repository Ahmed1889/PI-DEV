{% extends 'base2.html.twig' %}

{% block bodyBack %}

    <h1>List des Fournisseurs</h1>
    <table>
        <tr>
            <td>Rechercher: <input id="recherche" type="text" ></td>
            <td><div id="p"></div></td>
        </tr>
    </table>






    <div id="dii" style="overflow: scroll;height: 500px ">
        <table  class="table table-striped">
        <thead>
            <tr>
                <th >Id</th>
                <th >Fournisseur</th>
                <th>Tel </th>
                <th>Email</th>
                <th>Site web</th>
                <th>Categorie</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="student">
        {% for fournisseur in fournisseurs %}
            <tr>
                <td><a href="{{ path('fournisseur_show', { 'id': fournisseur.id }) }}">{{ fournisseur.id }}</a></td>
                <td>{{ fournisseur.nomf }}</td>
                <td>{{ fournisseur.telf }}</td>
                <td>{{ fournisseur.emailf }}</td>
                <td><a href="{{ fournisseur.sitewebf }}"> {{ fournisseur.sitewebf }}</a></td>
                {% if fournisseur.categorief == "Premium" %}
                    <td><span class="badge badge-pill badge-primary">{{ fournisseur.categorief }}</span></td>
                {% endif %}
                {% if fournisseur.categorief == "Gold" %}
                    <td><span class="badge badge-pill badge-warning">{{ fournisseur.categorief }}</span></td>
                {% endif %}
                {% if fournisseur.categorief == "Silver" %}
                    <td><span class="badge badge-pill badge-light">{{ fournisseur.categorief }}</span></td>
                {% endif %}
                <td>


                            <a class="fas fa-eye" href="{{ path('fournisseur_show', { 'id': fournisseur.id }) }}"></a><br>

                            <a class="fas fa-wrench" href="{{ path('fournisseur_edit', { 'id': fournisseur.id }) }}"></a>


                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    </div>

    <ul>
        <li>
            <a href="{{ path('fournisseur_new') }}">Créer Fournisseur</a>
        </li>
    </ul>

{% endblock %}
{% block js2 %}

    <script language = "javascript">

        $(document).ready(function(){

            $("#recherche").on("keyup",function(event){

 $r=$("#recherche").val();
                $.ajax({
                    url:        '{{ path('filter2') }}',
                    type:       'POST',
                    dataType:   'json',
                    data:{'nomf':$r},
                    async:      true,

                    success: function(data) {

                        var e=$('<tr><th>id</th><th>Nom</th><th>Tel</th><th>Email</th><th>Site Web</th><th>Categorie</th></tr>')
                        $("#student").html('');


                        var t;
                        for(i=0;i<data.length;i++) {
                            student = data[i];
                            if (student['categorief']== "Premium" )
                            t="badge badge-pill badge-primary";
                            else if((student['categorief']== "Gold" ))
                                t="badge badge-pill badge-warning";
                            else
                                t="badge badge-pill badge-light";

                            var e = $('<tr><td id="id"></td>' +
                                '<td id="nom"></td>' +
                                '<td id="tel"></td>' +
                                '<td id="email"></td>' +
                                '<td id="siteweb"><a href="'+student['sitewebf']+'">   '+student['sitewebf']+'   </a> </td>' +
                                '<td id="categorie"><span class="'+t+'"> '+student['categorief']+'</span></td>'+
                                '<td><a id="edit" class="fas fa-wrench" href="'+student["idf"]+'/edit"></a>'+
                                '<a id="show" class="fas fa-eye" href="'+student["idf"]+'/show"></a>'+
                                ' </td>'

                            );







                            $('#id', e).html(student['idf']);
                            $('#nom', e).html(student['nomf']);
                            $('#tel', e).html(student['telf']);
                            $('#email', e).html(student['emailf']);




                            $('#student').append(e);
                            $("#p").html("<span id='p'>Vous avez Trouvé  "+student['count']+" Resultats</span>");
                            $("#p").show();
                            $("#p").fadeOut(4000);



                        }
                    },
                    error : function(xhr, textStatus, errorThrown) {
                        alert('Ajax request failed.');
                    }
                });

        })
         });

    </script>






{%  endblock js2 %}
